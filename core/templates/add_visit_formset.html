{% extends "minimal.html" %}
{% load cms_tags sekizai_tags menu_tags static%}
{% load formsetify %}

{%  block content %}
<div class="container">
    <django-formset endpoint="{{ request.path }}" csrf-token="{{ csrf_token }}">
        {{ form_collection }}
      <p class="mt-3">
          {% if add %}
            <button type="button" df-click="submit -> proceed" class="btn btn-primary">Сохранить</button>
          {% else %}
            <button type="button" df-click="submit({update: true}) -> proceed" class="btn btn-primary">Обновить</button>
            <button type="button" df-click="submit({delete: true}) -> proceed" class="btn ms-2 btn-warning">Удалить</button>
          {% endif %}
      </p>
    </django-formset>
</div>

<div id="modaldialog"
    class="modal modal-blur fade"
    data-bs-backdrop="static"
    style="display: none"
    aria-hidden="false"
    tabindex="-1">
{#    data-bs-backdrop="static">#}
    <div class="modal-dialog modal-xl modal-dialog-centered" role="document">
        <div class="modal-content"></div>
    </div>
</div>

<script>
    {#var myModalEl = document.getElementById('modaldialog')#}
    {#myModalEl.addEventListener('hidden.bs.modal', function (event) {#}
    {#    document.getElementById('modaldialog').innerHTML = '';#}

        {#var input = document.getElementById('#id_visit_dishes.0.dish_form.dish_fk-ts-control');#}
        {#input.focus(); // you can also use input.focus()#}
        {#input.value="";#}
        {##}
        {#var text = "41";#}
        {#var l=text.length;#}
        {#var current = 0;#}
        {#var time = 1000;#}
        {##}
        {#var write_text = function() {#}
        {#  input.value+=text[current];#}
        {#  if(current < l-1) {#}
        {#    current++;#}
        {#    setTimeout(function(){write_text()},time);#}
        {#  } else {#}
        {#    input.setAttribute('value',input.value);#}
        {#  }#}
        {# }#}
        {#setTimeout(function(){write_text()},time);#}

        {#input = document.getElementById('#id_visit_dishes.0.dish_form.dish_fk');#}
        {#input.value = 'Борщ2';#}
        {#input.dispatchEvent(new KeyboardEvent('keydown', { bubbles: true }));#}
        {#input.dispatchEvent(new KeyboardEvent('keypress', { bubbles: true }));#}
        {#input.dispatchEvent(new KeyboardEvent('keyup', { bubbles: true }));#}
        {#input.dispatchEvent(new Event('input', { bubbles: true }));#}
        {#input.dispatchEvent(new Event('change', { bubbles: true }));#}

        {#let element = document.getElementById('id_visit_dishes.0.dish_form.dish_fk');#}
        {#element.value = '8';#}


    {# })#}
</script>

{% endblock %}